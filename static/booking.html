<!DOCTYPE html>
<html>

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css?family=Open+Sans:300,regular,500,600,700,800,300italic,italic,500italic,600italic,700italic,800italic&amp;subset=latin,latin-ext&amp;display=swap"
        type="text/css" media="all">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/vuetify@3.4.0/dist/vuetify.min.css">
</head>

<body>
  <div id="app">
    <v-app>
        <v-sheet max-width="500px" width="100%" class="mx-auto pt-4 pl-4 pr-4 pb-4">
            <div class="text-h2 mb-4">Boka friträning</div>

            <v-form fast-fail @submit.prevent>
                <v-text-field
                    v-model="form.title"
                    label="Titel"
                ></v-text-field>

                <v-text-field
                    v-model="form.description"
                    label="Beskrivning t.ex. Namn & Tel"
                ></v-text-field>

                <v-text-field
                    v-model="form.location"
                    readonly
                    label="Plats"
                ></v-text-field>

                <div class="text-h4">
                    Välj längd
                    <span v-if="form.duration"> - {{ form.duration }} minuter</span>
                </div>

                <v-slider color="primary" step="15"
                    show-ticks="always" min="30" max="120" :ticks="{ 30: '30 min', 60: '1h', 90: '90 min', 120: '2h' }"
                    v-model="form.duration"></v-slider>

                <div class="text-h4">
                    Välj datum
                </div>
                <v-date-picker show-adjacent-months class="mx-auto"
                    v-model="form.date"
                    hide-header
                    :min="minDate"
                    header="Välj längd" text="text" title=""
                    ></v-date-picker>


                    <div class="text-caption mb-4">Dubbelkolla att ingen annan aktivitet krockar<br/>
                    <a href="https://nackswinget.se/kalender/" _target="blank">Nackswingets Kalender (nytt fönster)</a>
                </div>

                <v-text-field
                    v-model="form.time"
                    type="time"
                    label="Tid"
                    min="06:00"
                    max="23:00"
                    pattern="[0-9]{2}:[0-9]{2}"
                ></v-text-field>

                <v-text-field
                    v-model="form.password"
                    type="password"
                    label="Lösenord"
                ></v-text-field>

                <v-btn type="submit" color="primary" block class="" @click="submit"
                    :disabled="!form.title || !form.description || !form.date || !form.duration || !form.time || !form.password">
                    Boka
                </v-btn>
            </v-form>
            <div class="text-caption mt-4">© Filip Lindqvist 2023</div>
        </v-sheet>
    </v-app>
  </div>


    <script async src="https://ga.jspm.io/npm:es-module-shims@1.8.0/dist/es-module-shims.js"></script>

    <script type="importmap">
    {
        "imports": {
            "vue": "https://unpkg.com/vue@3/dist/vue.esm-browser.js",
            "vuetify": "https://unpkg.com/vuetify@3.4.0/dist/vuetify.esm.js"
        }
    }
    </script>

    <script type="module">
        import { reactive, ref, createApp, onMounted } from 'vue'
        import { createVuetify, useDate } from 'vuetify'

        const vuetify = createVuetify()

        createApp({
            setup() {
                const date = useDate()
                const form = reactive({
                    title: 'Friträning',
                    description: '',
                    date: null,
                    time: null,
                    duration: null,
                    location: 'Ceylon',
                    password: null
                })
                async function submit() {
                    const body = {
                        ...form
                    }

                    const result = await fetch('./book', {
                        method: 'POST',
                        headers: { 'content-type': 'application/json' },
                        body: JSON.stringify(body)
                    })
                    const { status, statusText, ok} = result
                    if (ok) {
                        alert(JSON.stringify(result.json(), null, 2))
                    } else {
                        alert(JSON.stringify(result.json(), null, 2))
                    }
                }
                return { form, minDate: date.addDays(date.startOfDay(date.date()), 1), submit }
            }
        }).use(vuetify).mount('#app')
    </script>
    <style>
        #app {
            --nsw-red-lighter: #d2174c;
            --nsw-red: #F9064B;
            --nsw-red-darker: #d40741;
            --border-radius: 6px;
        }
        #app {
            font-family: 'Open Sans',Helvetica,Arial,Lucida,sans-serif;
            margin: 0 !important;
        }
    </style>
</body>

</html>